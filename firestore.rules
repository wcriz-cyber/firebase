rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ── DATOS DE USUARIO + TODAS SUS SUBCOLLECCIONES ─────────────────
    // {document=**} cubre: users/{uid}/admin/whitelist, users/{uid}/data, etc.
    match /users/{userId}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // ── CHAT DE SOPORTE ───────────────────────────────────────────────
    match /consultas_privadas/{userId}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
