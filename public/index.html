<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>5X</title>
    <meta name="theme-color" content="#0b0e11">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@500;700&family=Inter:wght@500;700;800&family=JetBrains+Mono:wght@500;700;800&family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://s3.tradingview.com/tv.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <style>
        /* ══════════════════════════════════════════
           SECCIÓN CHAT DE SOPORTE (UI LOCAL)
        ══════════════════════════════════════════ */
        #section-chat { padding: 0; overflow: hidden; display: none; flex-direction: column; height: calc(100vh - var(--safe-top) - 50px); }
        #section-chat.active { display: flex; opacity: 1; animation: slide-in 0.3s ease-out; }
        .chat-header { display: flex; align-items: center; gap: 10px; padding: 10px 14px; background: var(--surface); border-bottom: 1px solid var(--border); flex-shrink: 0; }
        .chat-header-avatar { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--brand), rgba(59,130,246,0.5)); display: flex; align-items: center; justify-content: center; color: #fff; flex-shrink: 0; }
        .chat-header-info { flex: 1; display: flex; flex-direction: column; gap: 1px; }
        .chat-header-name { font-family: var(--font-head); font-size: 13px; font-weight: 900; color: var(--text-primary); letter-spacing: 1px; }
        .chat-header-status { font-family: var(--font-head); font-size: 9px; color: var(--text-tertiary); letter-spacing: 0.5px; transition: color 0.3s; }
        .chat-header-status.online { color: var(--long); }
        .chat-messages { flex: 1; overflow-y: auto; padding: 12px 14px; display: flex; flex-direction: column; gap: 10px; scroll-behavior: smooth; overscroll-behavior: contain; -webkit-overflow-scrolling: touch; }
        .chat-messages::-webkit-scrollbar { width: 4px; }
        .chat-messages::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 2px; }
        .chat-empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; gap: 12px; color: var(--text-tertiary); text-align: center; padding: 40px 20px; }
        .chat-empty-state p { font-family: var(--font-head); font-size: 11px; font-weight: 600; line-height: 1.8; letter-spacing: 0.3px; }
        .chat-input-bar { display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: var(--surface); border-top: 1px solid var(--border); flex-shrink: 0; padding-bottom: calc(10px + var(--safe-bottom)); }
        .chat-input { flex: 1; background: var(--bg); border: 1px solid var(--border); border-radius: 22px; padding: 9px 14px; color: var(--text-primary); font-family: var(--font-head); font-size: 12px; font-weight: 600; outline: none; transition: border-color 0.2s; letter-spacing: 0.2px; }
        .chat-input:focus { border-color: var(--brand); }
        .chat-send-btn { width: 40px; height: 40px; border-radius: 50%; background: var(--brand); border: none; color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; transition: all 0.2s; box-shadow: 0 2px 8px rgba(59,130,246,0.4); }
        .chat-send-btn:active { transform: scale(0.9); }

        /* ════════════════════════════════════════
           GATE.IO COMMAND DASHBOARD
        ════════════════════════════════════════ */
        .gd-header { display: flex; align-items: center; justify-content: space-between; background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 10px 14px; margin-bottom: 8px; }
        .gd-conn-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--text-tertiary); flex-shrink: 0; transition: background 0.5s, box-shadow 0.5s; }
        .gd-conn-dot.connected { background: var(--long); box-shadow: 0 0 8px var(--long); animation: pulse-ring 2s infinite; }
        .gd-brand { font-family: var(--font-head); font-size: 15px; font-weight: 900; letter-spacing: 2px; color: var(--brand); }
        .gd-conn-label { font-family: var(--font-head); font-size: 9px; font-weight: 700; color: var(--text-tertiary); letter-spacing: 1px; transition: color 0.4s; }
        .gd-conn-label.connected { color: var(--long); }
        .gd-update-time { font-family: var(--font-num); font-size: 10px; color: var(--text-tertiary); }
        .gd-refresh-btn { background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.3); border-radius: 8px; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; color: var(--brand); }
        .gd-metrics-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px; margin-bottom: 6px; }
        .gd-metric-card { background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 10px 8px; text-align: center; display: flex; flex-direction: column; gap: 2px; position: relative; overflow: hidden; }
        .gd-metric-label { font-family: var(--font-head); font-size: 8px; font-weight: 700; color: var(--text-tertiary); letter-spacing: 0.8px; text-transform: uppercase; }
        .gd-metric-value { font-family: var(--font-num); font-size: 15px; font-weight: 800; color: var(--text-primary); line-height: 1.1; }
        .gd-metric-sub { font-family: var(--font-num); font-size: 9px; color: var(--text-tertiary); }
        .gd-mc-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: var(--brand); transition: width 0.3s linear; border-radius: 0; }
        .gd-mc-change { font-family: var(--font-num); font-size: 11px; font-weight: 800; padding: 1px 7px; border-radius: 6px; display: inline-block; }
        .gd-mc-change.up  { background: rgba(16,185,129,0.15); color: var(--long); }
        .gd-mc-change.down{ background: rgba(239,68,68,0.15);  color: var(--short); }
        .gd-portfolio-bar { background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 8px 10px; margin-top: 6px; display: flex; flex-direction: column; align-items: center; gap: 4px; min-height: 74px; }
        .gd-dual-label { font-family: var(--font-head); font-size: 8px; font-weight: 800; color: var(--text-tertiary); letter-spacing: 1.2px; text-transform: uppercase; }
        .gd-dual-scroll-wrap { width: 100%; overflow: hidden; position: relative; min-height: 36px; }
        .gd-dual-track { display: flex; transition: transform 0.45s cubic-bezier(0.4,0,0.2,1); width: 100%; }
        .gd-dual-slide { min-width: 100%; display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 0 4px; flex-shrink: 0; }
        .gd-slide-left  { display: flex; flex-direction: column; gap: 1px; }
        .gd-slide-right { display: flex; flex-direction: column; align-items: flex-end; gap: 1px; }
        .gd-slide-coin { font-family: var(--font-head); font-size: 18px; font-weight: 900; line-height: 1; }
        .gd-slide-detail { font-family: var(--font-num); font-size: 9px; color: var(--text-tertiary); }
        .gd-slide-inv { font-family: var(--font-num); font-size: 15px; font-weight: 800; color: var(--text-primary); line-height: 1; }
        .gd-slide-levels { font-family: var(--font-head); font-size: 9px; color: var(--text-tertiary); }
        .gd-dual-dots { display: flex; gap: 4px; align-items: center; }
        .gd-ddot { width: 5px; height: 5px; border-radius: 50%; background: var(--border); transition: all 0.3s; flex-shrink: 0; }
        .gd-ddot.active { background: var(--brand); width: 12px; border-radius: 3px; }

        :root { 
            --bg: #0a0e13; --surface: #141922; --surface-glass: #0a0e13; --card-bg: rgba(255, 255, 255, 0.03); 
            --border: #2b3139; --border-strong: #3d4451; --text-primary: #e5e7eb; --text-secondary: #9ca3af; 
            --text-tertiary: #6b7280; --brand: #3b82f6; --long: #10b981; --short: #ef4444; 
            --warning: #f59e0b; --danger: #dc2626; --zone-gold: #f59e0b; --zone-hot: #fb923c; --zone-warm: #94a3b8; 
            --radius-m: 16px; --chart-bg: #000000; --safe-top: env(safe-area-inset-top, 20px); 
            --safe-bottom: env(safe-area-inset-bottom, 20px); --skeleton: rgba(255,255,255,0.05); 
            --font-main: 'Orbitron', sans-serif; --font-head: 'Orbitron', sans-serif; --font-num: 'JetBrains Mono', monospace; 
            --fs-set-title: 14px; --fs-set-label: 11px; --fs-set-input: 16px; 
        }
        
        body.light-mode { --bg: #F2F0E9; --surface: #E8E6DF; --surface-glass: #F2F0E9; --card-bg: rgba(160, 150, 140, 0.08); --border: #D6D2C8; --border-strong: #BFBBB0; --text-primary: #4A453E; --text-secondary: #7A756D; --text-tertiary: #9E9890; --chart-bg: #F2F0E9; --skeleton: rgba(0,0,0,0.06); --short: #C87965; --danger: #C87965; --long: #6F9C76; --brand: #5C7C8A; --warning: #D99E4B; --zone-gold: #D99E4B; --zone-hot: #C87965; --zone-warm: #8C99A6; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { font-family: var(--font-main); font-weight: 500; background: var(--bg); color: var(--text-primary); padding-top: var(--safe-top); padding-bottom: calc(20px + var(--safe-bottom)); overflow-x: hidden; user-select: none; font-size: 16px; overscroll-behavior-y: none; transition: background 0.3s ease, color 0.3s ease; letter-spacing: 0.5px; }
        
        .bot-section { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-m); padding: 10px; margin-bottom: 8px; }
        .bot-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .bot-title { font-size: 18px; font-weight: 700; color: var(--text-primary); display: flex; align-items: center; gap: 4px; }
        .bot-toggle { position: relative; width: 54px; height: 28px; }
        .bot-toggle input { opacity: 0; width: 0; height: 0; }
        .bot-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #374151; transition: 0.3s; border-radius: 28px; }
        .bot-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: 0.3s; border-radius: 50%; }
        .bot-toggle input:checked + .bot-slider { background: linear-gradient(135deg, var(--long), #059669); }
        .bot-toggle input:checked + .bot-slider:before { transform: translateX(26px); }
        .bot-status { display: flex; align-items: center; gap: 4px; padding: 8px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 10px; font-size: 13px; margin-bottom: 8px; }
        .bot-status.inactive { background: rgba(107, 114, 128, 0.1); border-color: rgba(107, 114, 128, 0.3); color: var(--text-secondary); }
        .bot-status.active { background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); color: var(--long); }
        .bot-param-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-bottom: 6px; }
        .bot-param { background: rgba(255, 255, 255, 0.02); border: 1px solid var(--border); border-radius: 10px; padding: 8px; }
        .bot-param-label { font-size: 12px; color: var(--text-secondary); margin-bottom: 4px; display: block; }
        .bot-param-input { width: 100%; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 6px 8px; color: var(--text-primary); font-family: var(--font-num); font-size: 14px; text-align: center; }
        .bot-param-input:focus { outline: none; border-color: var(--brand); }
        .bot-info { font-size: 12px; color: var(--text-tertiary); line-height: 1.6; padding: 6px; background: rgba(245, 158, 11, 0.05); border-left: 3px solid var(--warning); border-radius: 6px; }
        .bot-slot-pill { text-align:center; padding:4px 2px; border-radius:8px; font-size:9px; font-weight:700; background:var(--surface-2); border:1px solid var(--border); color:var(--text-tertiary); line-height:1.3; }
        .bot-slot-pill.manual { border-color:var(--border); color:var(--text-tertiary); }
        .bot-slot-pill.waiting { border-color:var(--brand); color:var(--brand); background:rgba(59,130,246,0.08); }
        .bot-slot-pill.buying { border-color:var(--long); color:var(--long); background:rgba(16,185,129,0.1); animation:pulse-ring 1.5s infinite; }
        .bot-slot-pill.trailing { border-color:var(--warning); color:var(--warning); background:rgba(245,158,11,0.1); animation:pulse-ring 1.5s infinite; }
        .bot-slot-pill.paused { border-color:var(--danger); color:var(--danger); background:rgba(239,68,68,0.08); }
        
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--brand); }
        
        .brand-text, .nav-title, .setting-section-title, .theme-name-label { font-family: var(--font-head); }
        .ticker-price, .input-field, .stat-value, .u-val-primary { font-family: var(--font-num); }
        
        svg { fill: none; stroke: currentColor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2; pointer-events: none; transition: all 0.3s ease; }
        @keyframes pulse-ring { 0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); } 70% { box-shadow: 0 0 0 6px rgba(59, 130, 246, 0); } 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); } }
        @keyframes slide-in { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes grow-up { from { height: 0; opacity: 0; } to { opacity: 1; } }
        @keyframes breathe-real { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); } 50% { box-shadow: 0 0 15px 0 rgba(16, 185, 129, 0.3); border-color: var(--long); } 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); } }
        @keyframes breathe-gold { 0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); transform: scale(1); background: rgba(245, 158, 11, 0.1); } 50% { box-shadow: 0 0 20px 0 rgba(245, 158, 11, 0.4); border-color: #f59e0b; transform: scale(1.02); background: rgba(245, 158, 11, 0.2); } 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); transform: scale(1); background: rgba(245, 158, 11, 0.1); } }
        @keyframes breathe-radar { 0%   { box-shadow: 0 4px 12px rgba(0,0,0,0.2); border-color: var(--border); transform: scale(1); } 40%  { box-shadow: 0 6px 28px rgba(59,130,246,0.35); border-color: rgba(59,130,246,0.7); transform: scale(1.012); } 100% { box-shadow: 0 4px 12px rgba(0,0,0,0.2); border-color: var(--border); transform: scale(1); } }
        @keyframes breathe-active-slot { 0%   { box-shadow: 0 0 0 2px rgba(59,130,246,0.3), 0 8px 25px rgba(0,0,0,0.3); border-color: rgba(59,130,246,0.5); } 50%  { box-shadow: 0 0 0 3px rgba(59,130,246,0.7), 0 8px 35px rgba(0,0,0,0.4); border-color: var(--brand); } 100% { box-shadow: 0 0 0 2px rgba(59,130,246,0.3), 0 8px 25px rgba(0,0,0,0.3); border-color: rgba(59,130,246,0.5); } }
        @keyframes gold-flash-anim { 0% { background-color: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); } 50% { background-color: rgba(245, 158, 11, 0.25); border-color: rgba(245, 158, 11, 0.8); } 100% { background-color: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); } }
        
        .anim-click { transition: transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1), background-color 0.2s, border-color 0.2s; }
        .anim-click:active { transform: scale(0.92); opacity: 0.8; }
        .anim-pulse { animation: pulse-ring 2s infinite; }
        .section-enter { animation: slide-in 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .skeleton-box { background: var(--skeleton); background: linear-gradient(90deg, var(--skeleton) 25%, var(--card-bg) 50%, var(--skeleton) 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 4px; color: transparent !important; }
        .skeleton-text { display: inline-block; min-width: 40px; min-height: 1em; border-radius: 4px; }
        #toast { visibility: hidden; width: auto; max-width: 250px; background-color: var(--surface); border: 1px solid var(--border); color: var(--text-primary); text-align: center; border-radius: 16px; padding: 8px 16px; position: fixed; z-index: 9999; left: 50%; top: -100px; transform: translateX(-50%); font-weight: 700; font-size: 11px; font-family: var(--font-head); box-shadow: 0 4px 16px rgba(0,0,0,0.5); transition: top 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s ease; opacity: 0; backdrop-filter: blur(8px); }
        #toast.show { top: calc(15px + var(--safe-top)); visibility: visible; opacity: 1; }
        #toast.alert-mode { background-color: rgba(220, 38, 38, 0.9); color: #fff; border-color: var(--danger); }
        #toast.success-mode { background-color: rgba(16, 185, 129, 0.9); color: #fff; border-color: var(--long); }
        
        .fixed-header { position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; background: var(--bg); padding-top: var(--safe-top); transition: background 0.3s; border-bottom: none; }
        .app-header { display: flex; justify-content: space-between; align-items: center; height: 50px; padding: 0 16px; max-width: 1400px; margin: 0 auto; position: relative; }
        .brand-btn { display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 5px; position: relative; z-index: 50; transition: opacity 0.4s ease, transform 0.4s ease; opacity: 1; transform: translateX(0); }
        .theme-btn { width: 36px; height: 36px; border-radius: 50%; background: transparent; border: 1px solid var(--border); color: var(--text-primary); display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; position: relative; z-index: 50; transition: opacity 0.4s ease, transform 0.4s ease; opacity: 1; transform: translateX(0); }
        .brand-btn.hidden { opacity: 0; transform: translateX(-15px); pointer-events: none; }
        
        .user-menu-wrapper { position: relative; z-index: 200; }
        .user-btn { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--brand), rgba(59,130,246,0.6)); border: 1.5px solid var(--brand); color: #fff; display: flex; align-items: center; justify-content: center; font-size: 17px; flex-shrink: 0; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(59,130,246,0.3); }
        .user-btn:active { transform: scale(0.92); }
        .user-dropdown { position: absolute; top: calc(100% + 10px); right: 0; background: var(--surface); border: 1px solid var(--border); border-radius: 18px; min-width: 210px; box-shadow: 0 8px 32px rgba(0,0,0,0.45); overflow: hidden; display: none; animation: slide-in 0.25s cubic-bezier(0.16,1,0.3,1); z-index: 300; }
        .user-dropdown.open { display: block; }
        .user-drop-row1 { padding: 14px 16px 12px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
        .user-drop-5x { font-family: var(--font-head); font-size: 20px; font-weight: 900; color: var(--brand); letter-spacing: 2px; }
        .user-drop-theme-toggle { display: flex; align-items: center; gap: 5px; background: var(--bg); border: 1px solid var(--border); border-radius: 20px; padding: 5px 10px; cursor: pointer; transition: all 0.2s; }
        .user-drop-theme-toggle:active { transform: scale(0.94); background: rgba(59,130,246,0.1); border-color: var(--brand); }
        .user-drop-theme-label { font-family: var(--font-head); font-size: 9px; font-weight: 700; color: var(--text-tertiary); letter-spacing: 0.5px; }
        .user-drop-item { padding: 12px 16px; display: flex; align-items: center; gap: 10px; cursor: pointer; font-family: var(--font-head); font-size: 11px; font-weight: 700; color: var(--text-secondary); letter-spacing: 0.5px; transition: background 0.2s, color 0.2s; border-top: 1px solid var(--border); }
        .user-drop-item:first-child { border-top: none; }
        .user-drop-item:active { background: rgba(59,130,246,0.1); color: var(--brand); }
        .user-drop-item svg { flex-shrink: 0; color: var(--text-tertiary); }
        .user-drop-item:active svg { color: var(--brand); }
        
        .etf-float-btn { position: fixed; bottom: calc(90px + var(--safe-bottom)); right: 8px; width: 46px; height: 46px; border-radius: 50%; background: var(--brand); border: 2px solid var(--border); color: #fff; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; cursor: pointer; z-index: 999; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); transition: all 0.3s ease; }
        .etf-float-btn:hover { transform: scale(1.1); box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6); }
        .etf-float-btn:active { transform: scale(0.95); }
        .etf-float-btn.hidden { opacity: 0; pointer-events: none; transform: scale(0.8); }
        
        .panels-wrapper { position: fixed; top: calc(var(--safe-top) + 50px); left: 0; width: 100%; height: calc(100vh - var(--safe-top) - 50px); overflow: hidden; padding-bottom: var(--safe-bottom); }
        .panels-container { display: flex; width: 300%; height: 100%; transition: transform 0.2s ease-out; will-change: transform; }
        .panel { width: 33.3333%; height: 100%; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; flex-shrink: 0; }
        .panel-content { min-height: 100%; padding: 4px; }
        #panel0 { display:flex; flex-direction:column; }
        #panel0 .panel-content { flex:1; display:flex; flex-direction:column; min-height:0; overflow:hidden; }
        #dashboardsContainer { flex:1; display:flex; flex-direction:column; min-height:0; overflow-y:auto; overflow-x:hidden; -webkit-overflow-scrolling:touch; gap:0; padding-bottom:80px; }
        #dashboardsContainer .dashboard-card { flex:0 0 auto; min-height:130px; max-height:130px; margin:3px 4px !important; }
        .panels-container[data-active="0"] { transform: translateX(0%); }
        .panels-container[data-active="1"] { transform: translateX(-33.3333%); }
        .panels-container[data-active="2"] { transform: translateX(-66.6666%); }
        
        .panel-indicators { position: fixed; bottom: calc(10px + var(--safe-bottom)); left: 50%; transform: translateX(-50%); display: flex; gap: 8px; z-index: 998; pointer-events: none; }
        .panel-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--border); transition: all 0.3s ease; }
        .panel-dot.active { background: var(--brand); width: 24px; border-radius: 4px; }
        
        .usdt-display { display: flex; align-items: center; justify-content: center; gap: 8px; background: rgba(16, 185, 129, 0.1); border: 1px solid var(--long); padding: 8px 20px; border-radius: 20px; font-family: var(--font-num); font-weight: 800; font-size: 18px; color: var(--long); box-shadow: 0 0 10px rgba(16, 185, 129, 0.15); }
        .usdt-label { font-family: var(--font-head); font-size: 13px; font-weight: 900; letter-spacing: 2px; color: var(--long); }
        .usdt-amount { font-family: 'JetBrains Mono', monospace; font-size: 20px; font-weight: 800; color: var(--long); text-shadow: 0 0 8px rgba(16, 185, 129, 0.4); }
        
        .brand-text { font-family: var(--font-head); font-weight: 900; font-size: 24px; color: var(--brand); line-height: 1; }
        .ticker-container { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); display: flex; align-items: center; justify-content: center; width: 60%; max-width: 300px; z-index: 10; pointer-events: none; transition: all 0.5s cubic-bezier(0.25, 1, 0.5, 1); }
        .ticker-container.expanded { width: 95%; max-width: 600px; }
        .ticker-pill { display: flex; align-items: center; justify-content: center; gap: 12px; background: rgba(255,255,255,0.03); border: 1px solid var(--border); padding: 0 16px; border-radius: 24px; height: 40px; transition: all 0.4s ease; white-space: nowrap; overflow: hidden; width: 100%; pointer-events: auto; position: relative; }
        .ticker-pill.pinned-mode { border-color: var(--brand); background: rgba(59, 130, 246, 0.08); box-shadow: 0 0 10px rgba(59, 130, 246, 0.15); }
        .ticker-group-left { display: flex; align-items: center; gap: 6px; flex: 0 0 auto; }
        .ticker-group-right { display: flex; align-items: center; gap: 8px; flex: 0 0 auto; }
        .ticker-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--text-secondary); transition: background 0.3s; flex-shrink: 0; }
        .ticker-dot.pulse { animation: pulse-ring 1.5s infinite; }
        .ticker-sym { font-family: var(--font-head); font-weight: 800; font-size: 14px; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; }
        .ticker-price { font-family: var(--font-num); font-weight: 800; font-size: 16px; color: var(--text-primary); }
        .ticker-pct { font-family: var(--font-num); font-weight: 700; font-size: 12px; padding: 2px 6px; border-radius: 6px; }
        .ticker-pct.up { background: rgba(16, 185, 129, 0.15); color: var(--long); }
        .ticker-pct.down { background: rgba(239, 68, 68, 0.15); color: var(--short); }
        .content-spacer { margin-top: 80px; max-width: 800px; margin-left: auto; margin-right: auto; padding: 0 4px; transition: margin-top 0.3s; }
        .app-section { display: none; opacity: 0; transition: opacity 0.2s ease; }
        .app-section.active { display: block; opacity: 1; animation: slide-in 0.3s ease-out; }
        .tf-bar { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; padding: 4px 12px 6px 12px; justify-content: center; background: var(--bg); border: none; margin: 0; overflow: hidden; max-height: 50px; }
        .tf-btn { background: transparent; border: none; color: var(--text-tertiary); padding: 4px 0; text-align: center; font-family: sans-serif; font-size: 12px; font-weight: 700; border-radius: 8px 8px 0 0; transition: all 0.2s; }
        .tf-btn.active { color: var(--brand); background: rgba(59, 130, 246, 0.1); font-weight: 800; }
        
        .chart-wrapper { height: 280px; background: var(--chart-bg); margin: 0 10px 6px 10px; border-radius: var(--radius-m); border: 1px solid var(--border); overflow: hidden; position: relative; }
        .chart-wrapper.fullscreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 5000; margin: 0; border-radius: 0; border: none; padding-top: var(--safe-top); padding-bottom: var(--safe-bottom); background: var(--bg); }
        .price-lines-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; z-index: 10; }
        .price-line { position: absolute; left: 0; right: 0; height: 2px; display: flex; align-items: center; }
        .price-line.avg-line { background: linear-gradient(90deg, transparent, rgba(92, 124, 138, 0.5) 5%, rgba(92, 124, 138, 0.5) 95%, transparent); }
        .price-line.target-line { background: linear-gradient(90deg, transparent, rgba(217, 158, 75, 0.5) 5%, rgba(217, 158, 75, 0.5) 95%, transparent); border-top: 2px dashed var(--warning); }
        .price-line.buy-line { background: linear-gradient(90deg, transparent, rgba(111, 156, 118, 0.3) 5%, rgba(111, 156, 118, 0.3) 95%, transparent); }
        .price-label { position: absolute; right: 10px; background: rgba(10, 14, 19, 0.9); padding: 3px 8px; border-radius: 4px; font-family: var(--font-num); font-size: 10px; font-weight: 800; white-space: nowrap; backdrop-filter: blur(4px); top: -12px; }
        .price-label.avg { color: var(--brand); border-left: 3px solid var(--brand); }
        .price-label.target { color: var(--warning); border-left: 3px solid var(--warning); }
        .price-label.buy { color: var(--long); border-left: 3px solid var(--long); }
        .chart-fs-btn { position: absolute; bottom: 10px; right: 10px; z-index: 20; width: 30px; height: 30px; background: rgba(128,128,128,0.2); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: var(--text-primary); backdrop-filter: blur(4px); }
        
        .radar-ticker-large { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 12px 14px; margin: 4px 10px 10px; text-align: center; position: relative; cursor: pointer; transition: background 0.3s, opacity 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.2); min-height: 110px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; user-select: none; animation: breathe-radar 3s ease-in-out infinite; }
        .radar-ticker-large:active { transform: scale(0.98); background: var(--card-bg); }
        .radar-status-dot { position: absolute; top: 10px; left: 10px; width: 7px; height: 7px; border-radius: 50%; background: var(--long); box-shadow: 0 0 8px var(--long); }
        .radar-status-dot.offline { background: var(--danger); box-shadow: none; opacity: 0.5; }
        
        .number-display, #resInv, #resAvg, #resTarget, .stat-val, .u-val-primary, .u-val-secondary, .etf-change-badge, .etf-score-display, #totalBalanceDisplay, #radarValue, .ticker-price, #t-price, #t-pct, input[type="number"], .level-price, .level-profit, .level-qty { font-family: 'JetBrains Mono', monospace !important; font-weight: 700 !important; letter-spacing: 0.3px !important; }
        
        .radar-header-line { display: flex; flex-direction: column; align-items: center; gap: 6px; width: 100%; }
        .radar-title-compact { font-family: var(--font-head); font-size: 11px; font-weight: 900; color: var(--brand); letter-spacing: 2px; display: flex; align-items: center; gap: 5px; text-transform: uppercase; opacity: 0.8; }
        .radar-balance-compact { font-family: 'JetBrains Mono', monospace; font-size: 16px; font-weight: 800; color: var(--long); text-shadow: 0 0 12px rgba(16, 185, 129, 0.3); white-space: nowrap; letter-spacing: 0.5px; }
        .radar-token-centered { font-family: var(--font-num); font-weight: 800; font-size: 26px; color: var(--text-primary); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; text-align: center; width: 100%; }
        
        .dash-compact-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; grid-template-rows: auto auto; gap: 4px; }
        .dash-cell-coin { background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 6px 8px; display: flex; flex-direction: column; gap: 1px; }
        .dash-cell-coin-label { font-family: var(--font-head); font-size: 9px; font-weight: 700; color: var(--text-tertiary); letter-spacing: 1.5px; text-transform: uppercase; line-height: 1; }
        .dash-cell-coin-name { font-family: var(--font-head); font-weight: 900; font-size: 20px; color: var(--brand); text-transform: uppercase; line-height: 1.1; }
        .dash-cell { background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 6px 8px; display: flex; flex-direction: column; gap: 1px; position: relative; transition: all 0.2s; }
        .dash-cell:active { transform: scale(0.97); }
        .dash-cell.pressing { background: rgba(239, 68, 68, 0.1) !important; border-color: var(--danger) !important; }
        .dash-cell-label { font-family: var(--font-head); font-size: 9px; font-weight: 700; color: var(--text-tertiary); letter-spacing: 1.5px; text-transform: uppercase; line-height: 1; }
        .dash-cell-value { font-family: var(--font-num); font-size: 13px; font-weight: 800; color: var(--text-primary); line-height: 1.1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        .dashboard-card { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; margin: 6px 6px 6px; padding: 8px; box-shadow: 0 8px 25px rgba(0,0,0,0.3); position: relative; overflow: hidden; transition: background 0.3s, border-color 0.3s; }
        .dashboard-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: linear-gradient(90deg, var(--brand), var(--long)); }
        .dashboard-card.slot-active { border-color: var(--brand); box-shadow: 0 0 0 2px rgba(59,130,246,0.35), 0 8px 25px rgba(0,0,0,0.3); animation: breathe-active-slot 2.5s ease-in-out infinite; }
        .dashboard-card.slot-active::before { background: linear-gradient(90deg, var(--brand), var(--long)); height: 3px; }
        .dash-slot-label { font-family: var(--font-head); font-size: 8px; font-weight: 900; letter-spacing: 2px; color: var(--text-tertiary); text-align: right; margin-bottom: 4px; padding-right: 2px; }
        .dashboard-card.slot-active .dash-slot-label { color: var(--brand); }
        
        .trading-manual-btn { background: rgba(59, 130, 246, 0.1); border: 2px solid var(--brand); border-radius: 12px; padding: 0 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 1px; font-family: var(--font-head); font-weight: 900; font-size: 12px; letter-spacing: 0.8px; color: var(--brand); cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden; height: 44px; }
        .trading-manual-btn:active { transform: scale(0.98); background: rgba(59, 130, 246, 0.15); }
        .trading-manual-btn.auto-mode { background: rgba(16, 185, 129, 0.1); border-color: var(--long); color: var(--long); }
        
        .levels-container { padding: 8px 10px 8px 10px; display: flex; flex-direction: column; gap: 7px; padding-bottom: 8px; max-height: 100% !important; min-height: 0; height: auto; overflow-y: auto !important; overflow-x: hidden; -webkit-overflow-scrolling: touch; transition: opacity 0.3s ease; opacity: 1; position: relative; scroll-behavior: smooth; touch-action: pan-y !important; overscroll-behavior: contain; user-select: none; -webkit-user-select: none; }
        .levels-container::-webkit-scrollbar { width: 6px; }
        .levels-container::-webkit-scrollbar-track { background: rgba(255,255,255,0.03); border-radius: 3px; }
        .levels-container::-webkit-scrollbar-thumb { background: var(--brand); border-radius: 3px; }
        .levels-container::-webkit-scrollbar-thumb:hover { background: rgba(59, 130, 246, 1); }
        
        #etfGrid.levels-container { max-height: none; overflow-y: visible; padding: 0 10px; padding-bottom: 8px; padding-top: 0; }
        
        .unified-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: var(--radius-m); padding: 10px; display: grid; grid-template-columns: 44px 1fr auto; gap: 10px; align-items: center; cursor: pointer; transition: transform 0.1s ease, background 0.2s ease, border-color 0.3s, opacity 0.3s ease; position: relative; overflow: hidden; height: 82px !important; min-height: 82px !important; max-height: 82px !important; opacity: 0.75; flex-shrink: 0 !important; box-sizing: border-box !important; contain: layout style paint; will-change: auto; touch-action: pan-y !important; user-select: none; -webkit-user-select: none; }
        .unified-card:active { transform: scale(0.98); }
        .unified-card.is-pending { opacity: 1 !important; border: 1px dashed var(--warning) !important; background: rgba(245, 158, 11, 0.05) !important; transform: scale(1.0); }
        .unified-card.is-sent { opacity: 1 !important; border: 1px solid var(--warning) !important; background: rgba(245, 158, 11, 0.08) !important; transform: scale(1.0); }
        .unified-card.is-filled { opacity: 1 !important; background: rgba(16, 185, 129, 0.12) !important; border: 1px solid var(--long) !important; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.15); transform: scale(1.01); z-index: 5; }
        .order-status-badge { position: absolute; top: 4px; left: 48px; padding: 2px 6px; border-radius: 8px; font-size: 7px; font-weight: 800; font-family: var(--font-head); letter-spacing: 0.3px; text-transform: uppercase; z-index: 10; }
        .order-status-badge.pending { background: rgba(245, 158, 11, 0.2); color: var(--warning); border: 1px solid var(--warning); animation: pulse-ring 1.5s infinite; }
        .order-status-badge.filled { background: rgba(16, 185, 129, 0.2); color: var(--long); border: 1px solid var(--long); }
        
        .u-index { width: 42px; height: 42px; border-radius: 50%; background: rgba(59, 130, 246, 0.1); border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-family: var(--font-head); font-weight: 900; color: var(--text-tertiary); font-size: 15px; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin: 0 auto; transition: all 0.3s; }
        .unified-card.is-filled .u-index { background: var(--long); color: #fff; border-color: var(--long); box-shadow: 0 0 10px rgba(16, 185, 129, 0.4); }
        .u-center { display: flex; flex-direction: column; justify-content: center; overflow: hidden; gap: 6px; }
        .u-title { font-family: var(--font-num); font-size: 22px; font-weight: 800; color: var(--text-primary); line-height: 1; margin-bottom: 2px; }
        .u-sub { font-size: 11px; font-weight: 600; color: var(--text-tertiary); margin-top: 2px; text-transform: uppercase; }
        .u-right { text-align: right; display: flex; flex-direction: column; justify-content: center; gap: 4px; flex-shrink: 0; position: relative; }
        .u-val-primary { font-family: var(--font-num); font-size: 15px; font-weight: 800; }
        
        .etf-search-box { position: relative; margin: 0px 10px 2px 10px; } 
        .etf-search-input { width: 100%; background: var(--card-bg); border: 1px solid var(--border); padding: 14px 14px 14px 45px; border-radius: var(--radius-m); color: var(--text-primary); font-family: var(--font-head); font-weight: 700; font-size: 14px; transition: border 0.3s; }
        .etf-search-input:focus { border-color: var(--brand); }
        .etf-search-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary); }
        
        .setting-section-title { padding: 5px 5px; font-family: var(--font-head); color: var(--text-secondary); font-weight: 900; letter-spacing: 1.5px; display:flex; align-items:center; gap:8px; margin-top: 0px; font-size: var(--fs-set-title); }
        .settings-grid { display: flex; flex-direction: column; gap: 8px; }
        .setting-card-item { background: var(--card-bg); border: 1px solid var(--border); border-radius: var(--radius-m); padding: 16px; display: flex; flex-direction: column; gap: 5px; transition: background 0.3s, border-color 0.3s; }
        .setting-label { font-size: var(--fs-set-label); color: var(--text-secondary); font-weight: 700; text-transform: uppercase; }
        .setting-input { width: 100%; background: transparent; border: none; color: var(--text-primary); font-family: var(--font-num); font-size: var(--fs-set-input); font-weight: 700; }
        .input-row-save { display: flex; align-items: center; gap: 10px; width: 100%; }
        .btn-save-mini { background: var(--brand); color: #fff; border: none; width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; }
        .data-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .btn-data { background: var(--surface); border: 1px solid var(--border); color: var(--text-primary); padding: 12px; border-radius: 10px; font-size: 12px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .btn-reset { background: rgba(207, 48, 74, 0.1); color: var(--danger); border: 1px solid var(--danger); padding: 12px 20px; border-radius: 10px; font-weight: 900; width: 100%; margin-top: 10px; font-family: var(--font-head); cursor: pointer; display:flex; align-items:center; justify-content:center; gap:8px; }
        .multi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 5px; }
        
        #navModal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 2000; display: none; justify-content: center; align-items: center; padding-top: var(--safe-top); }
        .nav-content { background: var(--surface); width: 85%; max-width: 320px; border-radius: 30px; padding: 35px 25px; border: 1px solid var(--border); box-shadow: 0 30px 60px rgba(0,0,0,0.6); display: flex; flex-direction: column; gap: 15px; }
        .nav-title { font-family: var(--font-head); font-size: 18px; margin-bottom: 10px; color: var(--brand); text-align: center; font-weight: 900; letter-spacing: 2px; }
        .nav-item { display: flex; align-items: center; padding: 20px; border-radius: 18px; background: rgba(255,255,255,0.02); border: 1px solid var(--border); cursor: pointer; transition: 0.3s; }
        .nav-item.selected { background: rgba(59, 130, 246, 0.1); border-color: var(--brand); box-shadow: 0 5px 20px rgba(59, 130, 246, 0.15); }
        .nav-icon { width: 40px; height: 40px; margin-right: 20px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); }
        .nav-item.selected .nav-icon { color: var(--brand); }
        .nav-text { font-family: var(--font-head); font-weight: 700; font-size: 14px; letter-spacing: 1px; color: var(--text-primary); }
        .btn-close-menu { margin-top: 10px; width: 100%; padding: 16px; border-radius: 16px; border: 1px solid var(--border); background: var(--surface); color: var(--danger); font-family: var(--font-head); font-weight: 900; font-size: 13px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        
        .generic-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 3000; display: none; justify-content: center; align-items: center; }
        .modal-box { background: var(--surface); width: 85%; max-width: 300px; padding: 25px; border-radius: 20px; border: 1px solid var(--border); text-align: center; }
        .btn-modal { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: 700; margin-bottom: 8px; cursor: pointer; }
        .btn-confirm { background: var(--brand); color: #fff; }
        .btn-cancel { background: transparent; color: var(--text-secondary); }
        .modal-inp { width: 100%; background: var(--bg); border: 1px solid var(--border); padding: 12px; border-radius: 10px; color: var(--text-primary); font-size: 24px; letter-spacing: 5px; text-align: center; margin: 20px 0; font-family: var(--font-num); }
        .action-btn { background: var(--surface); border: 1px solid var(--brand); color: var(--brand); padding: 6px 12px; border-radius: 8px; font-size: 11px; font-weight: 800; cursor: pointer; font-family: var(--font-head); display: flex; align-items: center; gap: 5px; }
        
        .log-header-bar { display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 5px 16px 10px 16px; }
        .log-title { margin-bottom: 0px; font-family: var(--font-head); font-weight: 900; letter-spacing: 1px; color:var(--brand); }
        .log-actions { display: flex; gap: 15px; width: 100%; justify-content: center; }
        .stats-card { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; margin: 0 10px 15px; padding: 15px; }
        .stats-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .stats-title { font-family: var(--font-head); font-size: 12px; font-weight: 900; color: var(--brand); letter-spacing: 1px; }
        .stats-toggles { display: flex; gap: 5px; background: rgba(0,0,0,0.2); padding: 3px; border-radius: 8px; border: 1px solid var(--border); }
        .stat-btn { background: transparent; border: none; color: var(--text-tertiary); font-size: 10px; font-weight: 800; padding: 4px 10px; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
        .stat-btn.active { background: var(--brand); color: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .chart-box { height: 160px; display: flex; align-items: flex-end; justify-content: space-between; gap: 4px; padding-bottom: 5px; border-bottom: 1px solid var(--border); margin-bottom: 10px; position: relative; }
        .chart-bar { flex: 1; min-width: 4px; border-radius: 2px 2px 0 0; position: relative; transition: height 0.5s ease; animation: grow-up 0.5s ease-out; }
        .chart-bar.win { background: linear-gradient(to top, rgba(16,203,129,0.3), var(--long)); }
        .chart-bar.loss { background: linear-gradient(to top, rgba(246,70,93,0.3), var(--short)); }
        .stats-summary { display: flex; justify-content: space-between; align-items: center; font-size: 12px; }
        .sum-label { color: var(--text-tertiary); font-weight: 700; margin-right: 5px; }
        .sum-val { font-family: var(--font-num); font-weight: 800; color: var(--text-primary); }
        
        #logGrid { max-height: 395px; overflow-y: auto; overscroll-behavior: contain; border-bottom: 1px solid var(--border); margin-bottom: 20px; padding-right: 2px; }
        #logGrid::-webkit-scrollbar { width: 4px; }
        #logGrid::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
        .modal-info-text { font-size: 12px; color: var(--text-secondary); margin-bottom: 15px; }
        .trade-details { background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; margin-bottom: 15px; font-family: var(--font-num); font-size: 13px; text-align: left; }
        
        .dash-base-edit-input { background: transparent; border: none; border-bottom: 2px solid var(--brand); color: var(--brand); font-family: var(--font-num); font-size: 13px; font-weight: 800; text-align: center; width: 100%; outline: none; padding: 2px 0; -webkit-text-fill-color: var(--brand); letter-spacing: 0.3px; }
        .dash-cell.editing-base { border-color: var(--brand) !important; background: rgba(59,130,246,0.1) !important; animation: breathe-real 2s ease-in-out infinite; }
        .dash-cell.editing-base .dash-cell-label { color: var(--brand); }
        
        .slot-rank-badge { display: inline-block; background: linear-gradient(90deg, rgba(245,158,11,0.2), rgba(245,158,11,0.05)); border: 1px solid rgba(245,158,11,0.5); border-radius: 6px; padding: 0px 5px; font-size: 8px; font-weight: 900; color: var(--warning); margin-left: 5px; letter-spacing: 0.5px; }
        .slot-rank-badge.rank-1 { background: linear-gradient(90deg, rgba(245,158,11,0.3),rgba(245,158,11,0.08)); border-color: var(--warning); color: var(--warning); }
        .slot-rank-badge.rank-2 { background: rgba(107,114,128,0.15); border-color: var(--border-strong); color: var(--text-secondary); }
        .slot-rank-badge.rank-3 { background: rgba(180,100,40,0.15); border-color: rgba(180,100,40,0.4); color: #b46428; }

        #notifPermBanner { position: fixed; bottom: calc(70px + var(--safe-bottom)); left: 12px; right: 12px; background: linear-gradient(135deg, #1a2235, #141922); border: 1px solid rgba(59,130,246,0.5); border-radius: 18px; padding: 14px 16px; z-index: 9990; display: none; flex-direction: column; gap: 10px; box-shadow: 0 8px 32px rgba(0,0,0,0.5), 0 0 0 1px rgba(59,130,246,0.2); animation: slide-in 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        #notifPermBanner.visible { display: flex; }
        .notif-banner-top { display: flex; align-items: center; gap: 12px; }
        .notif-banner-icon { width: 42px; height: 42px; flex-shrink: 0; background: linear-gradient(135deg, rgba(59,130,246,0.3), rgba(139,92,246,0.2)); border: 1px solid rgba(59,130,246,0.4); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .notif-banner-text { flex: 1; }
        .notif-banner-title { font-family: var(--font-head); font-size: 11px; font-weight: 900; color: var(--text-primary); letter-spacing: 0.5px; margin-bottom: 2px; }
        .notif-banner-sub { font-family: var(--font-head); font-size: 9px; font-weight: 600; color: var(--text-tertiary); letter-spacing: 0.3px; line-height: 1.5; }
        .notif-banner-close { width: 28px; height: 28px; border-radius: 50%; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text-tertiary); display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; font-size: 12px; }
        .notif-banner-btns { display: flex; gap: 8px; }
        .notif-btn-allow { flex: 1; padding: 10px; border-radius: 12px; background: var(--brand); border: none; color: #fff; font-family: var(--font-head); font-size: 11px; font-weight: 900; letter-spacing: 0.5px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .notif-btn-allow:active { transform: scale(0.96); opacity: 0.85; }
        .notif-btn-later { padding: 10px 16px; border-radius: 12px; background: transparent; border: 1px solid var(--border); color: var(--text-tertiary); font-family: var(--font-head); font-size: 10px; font-weight: 700; cursor: pointer; transition: all 0.2s; }
        .notif-btn-later:active { background: rgba(255,255,255,0.05); }

        .notif-status-row { display: flex; align-items: center; justify-content: space-between; background: var(--card-bg); border: 1px solid var(--border); border-radius: 14px; padding: 12px 16px; margin-bottom: 8px; }
        .notif-status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--text-tertiary); flex-shrink: 0; }
        .notif-status-dot.granted { background: var(--long); box-shadow: 0 0 8px var(--long); animation: pulse-ring 2s infinite; }
        .notif-status-dot.denied  { background: var(--short); }

        /* Ajuste responsivo */
        @media (min-width: 768px) { 
            .content-spacer { padding: 4px; margin-top: 78px !important; max-width: 100%; } 
            #layout-container { display: grid; grid-template-columns: 25% 50% 25%; gap: 4px; height: calc(100vh - 82px); } 
            #tv_chart { width: 100% !important; height: 100% !important; margin: 0 !important; } 
            .panels-wrapper { display: none !important; }
            .panel-indicators { display: none !important; }
        }
    </style>
</head>
<body onload="init()">
    <div id="customConfirmModal">
        <div class="confirm-dialog">
            <div class="confirm-title" id="confirmTitle">¿Comprar nivel?</div>
            <div class="confirm-message" id="confirmMessage">$0.00 USDT</div>
            <div class="confirm-buttons">
                <button class="confirm-btn confirm-btn-cancel" onclick="closeConfirmModal(false)">Cancelar</button>
                <button class="confirm-btn confirm-btn-accept" onclick="closeConfirmModal(true)">Aceptar</button>
            </div>
        </div>
    </div>

    <div id="notifPermBanner">
        <div class="notif-banner-top">
            <div class="notif-banner-icon">🔔</div>
            <div class="notif-banner-text">
                <div class="notif-banner-title">ACTIVAR ALERTAS</div>
                <div class="notif-banner-sub">Recibe notificaciones de objetivos alcanzados, compras ejecutadas y alertas de precio aunque cierres la app.</div>
            </div>
            <div class="notif-banner-close" onclick="dismissNotifBanner()">✕</div>
        </div>
        <div class="notif-banner-btns">
            <button class="notif-btn-allow" onclick="requestNotifPermission()">ACTIVAR NOTIFICACIONES</button>
            <button class="notif-btn-later" onclick="dismissNotifBanner()">Ahora no</button>
        </div>
    </div>

    <audio id="alertSound" preload="auto" src="data:audio/wav;base64,UklGRl9vT1BXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU"></audio>
    <div id="toast">Notificación</div>
    
    <div class="etf-float-btn anim-click" id="etfFloatBtn" onclick="goToETFMonitor()" title="Ir a Monitor ETF">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </div>

    <div id="navModal" onclick="if(event.target===this) closeMenuViaButton()">
        <div class="nav-content section-enter">
            <div class="nav-title">MENÚ 5X</div>
            <div class="nav-item anim-click" id="nav-etf" onclick="switchView('etf')"><div class="nav-icon anim-pulse"><svg width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg></div><div class="nav-text">MONITOR ETF</div></div>
            <div class="nav-item anim-click" id="nav-log" onclick="switchView('log')"><div class="nav-icon"><svg width="24" height="24" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg></div><div class="nav-text">BITÁCORA</div></div>
            <div class="nav-item anim-click" id="nav-settings" onclick="switchView('settings')"><div class="nav-icon anim-spin"><svg width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></div><div class="nav-text">AJUSTES</div></div>
            <button class="btn-close-menu anim-click" onclick="closeMenuViaButton()">CERRAR MENÚ</button>
        </div>
    </div>

    <div class="fixed-header">
        <header class="app-header">
            <div class="brand-btn"><span class="brand-text">5X</span></div>
            <div class="ticker-container" id="tickerContainer">
                <div class="ticker-pill anim-click" id="mainTickerPill">
                    <div class="ticker-group-left"><div class="ticker-dot" id="t-dot"></div><span class="ticker-sym" id="t-sym">BTC</span></div>
                    <div class="ticker-group-right"><span class="ticker-price" id="t-price"><span class="skeleton-text skeleton-box"></span></span><span class="ticker-pct" id="t-pct">--%</span></div>
                </div>
            </div>
            
            <div class="user-menu-wrapper" id="userMenuWrapper">
                <div class="user-btn anim-click" onclick="toggleUserMenu()" title="Menú usuario" id="userAvatarBtn">
                    <span id="userAvatarEmoji">👤</span>
                </div>
                <div class="user-dropdown" id="userDropdown">
                    <div class="user-drop-row1">
                        <span class="user-drop-5x">5X</span>
                        <div class="user-drop-theme-toggle anim-click" onclick="toggleTheme(); updateThemeIcon();" id="themeToggleBtn">
                            <span id="themeHint">🌙</span>
                            <span class="user-drop-theme-label" id="themeLabel">OSCURO</span>
                        </div>
                    </div>
                    <div class="user-drop-item" onclick="closeUserMenu(); switchView('etf');">MONITOR ETF</div>
                    <div class="user-drop-item" onclick="closeUserMenu(); switchView('log');">BITÁCORA</div>
                    <div class="user-drop-item" id="chatSoporteMenuItem" onclick="closeUserMenu(); switchView('chat');">SOPORTE</div>
                    <div class="user-drop-item" onclick="closeUserMenu(); switchView('settings');">AJUSTES</div>
                </div>
            </div>
        </header>
    </div>

    <div class="content-spacer">
        <div id="section-operate" class="app-section active">
            <div class="panels-wrapper">
                <div class="panels-container" id="panelsContainer" data-active="0">
                    <div class="panel" id="panel1">
                        <div class="panel-content" style="padding: 4px; overflow-y: auto;">
                            <div class="tf-bar" id="tfBarContainer">
                                <button class="tf-btn anim-click" data-tf="15" onclick="updateTF('15', this)">15M</button><button class="tf-btn anim-click" data-tf="30" onclick="updateTF('30', this)">30M</button><button class="tf-btn anim-click" data-tf="60" onclick="updateTF('60', this)">1H</button><button class="tf-btn anim-click" data-tf="240" onclick="updateTF('240', this)">4H</button><button class="tf-btn anim-click" data-tf="D" onclick="updateTF('D', this)">1D</button>
                            </div>
                            <div id="tv_chart" class="chart-wrapper" style="margin: 6px 4px;">
                                <div id="priceLinesOverlay" class="price-lines-overlay"></div>
                                <div class="chart-fs-btn anim-click" onclick="toggleFullscreenChart(event)">
                                    <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>
                                </div>
                            </div>
                            <div style="padding: 0 4px 8px 4px;">
                                <div id="radarTickerContainer" class="radar-ticker-large anim-pulse">
                                    <div id="radarStatus" class="radar-status-dot offline"></div>
                                    <div class="radar-header-line">
                                        <div class="radar-title-compact" onclick="switchView('etf');">RADAR</div>
                                        <div id="radarValue" class="radar-token-centered"><span class="skeleton-text skeleton-box" style="width:80px; height:18px;"></span></div>
                                        <div class="radar-balance-compact" id="totalBalanceDisplay" style="display:none;"></div>
                                    </div>
                                </div>
                                <div id="desktop-etf-list"></div>
                            </div>

                            <div style="padding: 0 4px 80px 4px;">
                                <div class="gd-header">
                                    <div style="display:flex; align-items:center; gap:8px;">
                                        <div class="gd-conn-dot" id="gdConnDot"></div>
                                        <span class="gd-brand">GATE.IO</span>
                                        <span class="gd-conn-label" id="gdConnLabel">DESCONECTADO</span>
                                    </div>
                                    <div style="display:flex; align-items:center; gap:8px;">
                                        <span class="gd-update-time" id="gdUpdateTime">--:--:--</span>
                                        <button class="gd-refresh-btn anim-click" onclick="refreshGateDashboard()">↻</button>
                                    </div>
                                </div>
                                <div class="gd-metrics-grid">
                                    <div class="gd-metric-card">
                                        <span class="gd-metric-label">TOTAL WALLET</span>
                                        <span class="gd-metric-value" id="gdTotal">$0.00</span>
                                        <span class="gd-metric-sub" id="gdTotalBTC">≈ 0.000 BTC</span>
                                    </div>
                                    <div class="gd-metric-card">
                                        <span class="gd-metric-label">USDT LIBRE</span>
                                        <span class="gd-metric-value" style="color:var(--long)" id="gdLibre">$0.00</span>
                                        <span class="gd-metric-sub" id="gdLibrePct">0% disponible</span>
                                    </div>
                                    <div class="gd-metric-card">
                                        <span class="gd-metric-label">EN OPERACIÓN</span>
                                        <span class="gd-metric-value" style="color:var(--warning)" id="gdEnUso">$0.00</span>
                                        <span class="gd-metric-sub" id="gdSlotCount">0 slots activos</span>
                                    </div>
                                </div>
                                <div class="gd-metrics-grid">
                                    <div class="gd-metric-card">
                                        <span class="gd-metric-label">PNL HOY</span>
                                        <span class="gd-metric-value" id="gdPnlHoy">$0.00</span>
                                        <span class="gd-metric-sub">sesión actual</span>
                                    </div>
                                    <div class="gd-metric-card">
                                        <span class="gd-metric-label">PNL TOTAL</span>
                                        <span class="gd-metric-value" id="gdPnlTotal">$0.00</span>
                                        <span class="gd-metric-sub">acumulado</span>
                                    </div>
                                    <div class="gd-metric-card" id="gdMarketCard" style="cursor:pointer;" onclick="gdJumpToNext()">
                                        <span class="gd-metric-label" style="display:flex;align-items:center;gap:5px;">
                                            <span id="gdMcSym">BTC</span>
                                            <span class="gd-live-dot"></span>
                                        </span>
                                        <span class="gd-metric-value" id="gdMcPrice">$0.00</span>
                                        <span class="gd-mc-change" id="gdMcChange" style="align-self:center;">0.00%</span>
                                        <div class="gd-mc-progress" id="gdMcProgress"></div>
                                    </div>
                                </div>
                                <div class="gd-portfolio-bar">
                                    <span class="gd-dual-label">PORTAFOLIO 5X</span>
                                    <div class="gd-dual-scroll-wrap"><div class="gd-dual-track" id="gdPortfolioTrack"></div></div>
                                    <div class="gd-dual-dots" id="gdPortfolioDots"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel" id="panel0">
                        <input type="text" id="coinInput" style="display: none;" readonly>
                        <input type="number" id="capitalInput" style="display: none;">
                        <input type="number" id="baseInput" style="display: none;">
                        <div id="priceAdjustIndicator" style="display:none; position:fixed; bottom:calc(72px + var(--safe-bottom)); right:10px; background:rgba(245,158,11,0.15); border:1px solid var(--warning); border-radius:8px; padding:4px 8px; font-size:9px; font-family:var(--font-head); color:var(--warning); z-index:100;">📉 PRECIO AJUSTADO</div>
                        <div class="panel-content" style="padding: 4px; overflow-y: auto;">
                            <div id="dashboardsContainer"></div>
                        </div>
                    </div>
                    
                    <div class="panel" id="panel5">
                        <div class="panel-content" style="padding: 4px; overflow-y: auto; padding-bottom: 80px;">
                            <div class="tf-bar" id="tfBarContainer2">
                                <button class="tf-btn anim-click" data-tf="15" onclick="updateTF('15', this)">15M</button><button class="tf-btn anim-click" data-tf="30" onclick="updateTF('30', this)">30M</button><button class="tf-btn anim-click" data-tf="60" onclick="updateTF('60', this)">1H</button><button class="tf-btn anim-click" data-tf="240" onclick="updateTF('240', this)">4H</button><button class="tf-btn anim-click" data-tf="D" onclick="updateTF('D', this)">1D</button>
                            </div>
                            <div id="tv_chart2" class="chart-wrapper">
                                <div id="priceLinesOverlay2" class="price-lines-overlay"></div>
                                <div class="chart-fs-btn anim-click" onclick="toggleFullscreenChart2(event)">
                                    <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>
                                </div>
                            </div>
                            <main id="levelsGrid" class="levels-container"></main>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-indicators" id="panelIndicators">
                <div class="panel-dot active"></div>
                <div class="panel-dot"></div>
                <div class="panel-dot"></div>
            </div>
        </div>

        <div id="section-etf" class="app-section">
            <div class="etf-search-box">
                <span class="etf-search-icon">🔍</span>
                <input type="text" class="etf-search-input" id="etfSearchInput" placeholder="BUSCAR TOKEN (Ej: BTC, SUI)" oninput="filterETFs(this.value)" onfocus="this.select()">
            </div>
            <div id="etfGrid" class="levels-container"></div>
        </div>

        <div id="section-log" class="app-section">
            <div class="log-header-bar">
                <div class="log-title">BITÁCORA</div>
                <div class="log-actions">
                    <button class="action-btn anim-click" onclick="exportPDF()">📄 REPORTE</button>
                    <button class="action-btn anim-click" onclick="triggerDriveBackup()">☁️ RESPALDO</button>
                    <button class="action-btn anim-click" style="color:var(--danger); border-color:var(--danger)" onclick="clearLogs()">🗑️ BORRAR</button>
                </div>
            </div>
            <div class="stats-card anim-click">
                <div class="stats-header"><div class="stats-title">RENDIMIENTO</div><div class="stats-toggles"><button class="stat-btn active" onclick="updateStats('D')">1D</button><button class="stat-btn" onclick="updateStats('W')">1S</button><button class="stat-btn" onclick="updateStats('M')">1M</button><button class="stat-btn" onclick="updateStats('A')">TODO</button></div></div>
                <div class="chart-box" id="pnlChart"></div>
                <div class="stats-summary"><div><span class="sum-label">NETO (FEES INC.)</span><span class="sum-val" id="chartNeto">$0.00</span></div><div><span class="sum-label">WIN RATE</span><span class="sum-val" id="chartWr">0%</span></div></div>
            </div>
            <div id="logGrid" class="levels-container"></div>
        </div>

        <div id="section-settings" class="app-section">
            <div class="setting-section-title">🔔 NOTIFICACIONES</div>
            <div class="settings-grid" style="margin-bottom:10px;">
                <div class="setting-card-item" style="padding:14px 16px;">
                    <div class="notif-status-row" style="background:transparent; border:none; padding:0; margin-bottom:12px;">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="notif-status-dot" id="notifStatusDot"></div>
                            <div>
                                <div style="font-family:var(--font-head); font-size:11px; font-weight:800; color:var(--text-primary);">ESTADO</div>
                                <div id="notifStatusLabel" style="font-family:var(--font-head); font-size:9px; font-weight:700; color:var(--text-tertiary); letter-spacing:1px;">VERIFICANDO...</div>
                            </div>
                        </div>
                        <button id="notifSettingsBtn" class="btn-save-mini anim-click" onclick="handleNotifSettingsBtn()" style="font-size:10px; padding:8px 14px;">ACTIVAR</button>
                    </div>
                    <div style="font-family:var(--font-head); font-size:9px; color:var(--text-tertiary); line-height:1.8; letter-spacing:0.3px;">
                        Recibe alertas en el panel de notificaciones de Android:<br>
                        🎯 <b style="color:var(--text-secondary)">Objetivo alcanzado</b> · 
                        📥 <b style="color:var(--text-secondary)">Nivel comprado</b> · 
                        💰 <b style="color:var(--text-secondary)">Venta ejecutada</b> · 
                        🤖 <b style="color:var(--text-secondary)">Alertas del bot</b>
                    </div>
                </div>
            </div>

            <div class="setting-section-title">⚙️ API & TRADING (GATE.IO)</div>
            <div class="settings-grid">
                <div class="setting-card-item">
                    <div class="input-row-save" style="margin-bottom:10px; justify-content:space-between;"><span class="setting-label">CREDENCIALES API</span><button class="btn-save-mini anim-click" onclick="saveApiKeysSecure()">💾</button></div>
                    <div style="display:flex; flex-direction:column; gap:10px"><input type="password" class="setting-input" id="apiKey" placeholder="API KEY (KEY)" style="border-bottom:1px solid var(--border)"><input type="password" class="setting-input" id="apiSecret" placeholder="API SECRET (SECRET)"></div>
                </div>
                <div class="setting-card-item">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;"><span class="setting-label">🔧 DIAGNÓSTICO</span><div style="display:flex;gap:6px;"><button class="btn-save-mini anim-click" onclick="fullSyncGateAccount(false)" style="background:var(--long); color:#fff;">🔄 SYNC</button><button class="btn-save-mini anim-click" onclick="testApiConnection()" style="background:var(--brand); color:#fff;">PROBAR</button></div></div>
                    <div id="apiTestResult" style="font-size:11px; color:var(--text-tertiary); padding:8px; background:rgba(0,0,0,0.2); border-radius:8px; font-family:monospace; max-height:120px; overflow-y:auto;">Presiona PROBAR para verificar conexión</div>
                </div>
            </div>

            <div class="setting-section-title" style="border-left:3px solid var(--brand); padding-left:8px;">💰 CAPITAL & RENDIMIENTO</div>
            <div class="settings-grid">
                <div class="setting-card-item">
                    <div class="input-row-save" style="margin-bottom:10px;"><span class="setting-label" style="flex:1">CAPITAL TOTAL BASE ($)</span><button class="btn-save-mini anim-click" onclick="saveGlobalCapSecure()">💾</button></div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px"><input type="number" class="setting-input" id="setGlobalCapital" placeholder="0.00" style="border-bottom:1px solid var(--border)"><div><label class="setting-label">COMISIÓN EXCHANGE (%)</label><input type="number" class="setting-input" id="setFee" placeholder="0.1" step="0.01"></div></div>
                </div>
                <div class="setting-card-item"><label class="setting-label">GANANCIA MES ACTUAL</label><div id="monthlyProfitDisplay" style="font-family:var(--font-num); font-size:16px; font-weight:800; color:var(--text-primary);">$0.00 <span style="font-size:12px; color:var(--text-tertiary)">(0%)</span></div></div>
            </div>

            <div class="setting-section-title" style="border-left:3px solid var(--brand); padding-left:8px;">📊 ESTRATEGIA Y GESTIÓN</div>
            <div class="settings-grid">
                <div class="setting-card-item">
                    <div class="input-row-save" style="margin-bottom:10px; justify-content:space-between;"><span class="setting-label" style="color:var(--brand);">⚡ ESTRATEGIA NORMAL</span><button class="btn-save-mini anim-click" onclick="saveStrategyParams('normal')">💾</button></div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"><div><label class="setting-label">CAPITAL ($)</label><input type="number" class="setting-input" id="setCapitalNormal" value="5"></div><div><label class="setting-label">ROI (%)</label><input type="number" class="setting-input" id="setRoiNormal" value="100"></div><div><label class="setting-label">NIVEL 2+ (%)</label><input type="number" class="setting-input" id="setIncNormal" value="7"></div><div><label class="setting-label">NIVEL 1 (%)</label><input type="number" class="setting-input" id="setDescNormal" value="17"></div><div><label class="setting-label">DD MAX (%)</label><input type="number" class="setting-input" id="setDDNormal" value="17"></div></div>
                </div>
            </div>

            <div class="bot-section">
                <div class="bot-header"><div class="bot-title"><span>🤖</span><span>BOT AUTOMÁTICO</span></div><label class="bot-toggle"><input type="checkbox" id="botEnabled" onchange="toggleBot()"><span class="bot-slider"></span></label></div>
                <div class="bot-status inactive" id="botStatus"><span>⚫</span><span id="botStatusText">Bot desactivado</span></div>
                <div id="botSlotStatus" style="display:grid; grid-template-columns:repeat(5,1fr); gap:4px; margin:6px 0;">
                    <div class="bot-slot-pill" id="bss-0">S1<br><span id="bss-lbl-0" style="font-size:8px;">—</span></div>
                    <div class="bot-slot-pill" id="bss-1">S2<br><span id="bss-lbl-1" style="font-size:8px;">—</span></div>
                    <div class="bot-slot-pill" id="bss-2">S3<br><span id="bss-lbl-2" style="font-size:8px;">—</span></div>
                    <div class="bot-slot-pill" id="bss-3">S4<br><span id="bss-lbl-3" style="font-size:8px;">—</span></div>
                    <div class="bot-slot-pill" id="bss-4">S5<br><span id="bss-lbl-4" style="font-size:8px;">—</span></div>
                </div>
                <div class="bot-param-grid">
                    <div class="bot-param"><label class="bot-param-label">Caída Anti-crash (%)</label><input type="number" class="bot-param-input" id="botCrashDrop" value="15" min="5" max="50" step="1" onchange="saveBotConfig()"></div>
                    <div class="bot-param"><label class="bot-param-label">Ventana crash (min)</label><input type="number" class="bot-param-input" id="botCrashWindow" value="5" min="1" max="30" step="1" onchange="saveBotConfig()"></div>
                    <div class="bot-param"><label class="bot-param-label">Niveles máx/slot</label><input type="number" class="bot-param-input" id="botMaxLevels" value="12" min="1" max="12" step="1" onchange="saveBotConfig()"></div>
                    <div class="bot-param"><label class="bot-param-label">Reinicio auto (min)</label><input type="number" class="bot-param-input" id="botRestartDelay" value="0" min="0" max="1440" step="15" onchange="saveBotConfig()"></div>
                </div>
            </div>

            <div class="setting-section-title" style="border-left:3px solid var(--brand); padding-left:8px;">🛠️ AJUSTES AVANZADOS</div>
            <div class="settings-grid">
                <div class="setting-card-item">
                     <div class="input-row-save" style="justify-content:space-between; margin-bottom:10px; border-bottom:1px solid var(--border); padding-bottom:8px;"><span class="setting-label">RADAR & MONITOR</span><button class="btn-save-mini anim-click" onclick="saveRadarSecure()">💾</button></div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;"><div><label class="setting-label" style="display:block; margin-bottom:4px;">ITEMS RADAR</label><input type="number" class="setting-input" id="setRadarLimit" placeholder="12" style="background:rgba(0,0,0,0.2); border-radius:8px; padding:6px; text-align:center;"></div><div><label class="setting-label" style="display:block; margin-bottom:4px;">ITEMS MONITOR</label><input type="number" class="setting-input" id="setMonitorLimit" placeholder="20" style="background:rgba(0,0,0,0.2); border-radius:8px; padding:6px; text-align:center;"></div><div><label class="setting-label" style="display:block; margin-bottom:4px;">VEL. RADAR (s)</label><input type="number" class="setting-input" id="setRadarSpeed" placeholder="3" style="background:rgba(0,0,0,0.2); border-radius:8px; padding:6px; text-align:center;"></div><div><label class="setting-label" style="display:block; margin-bottom:4px;">VEL. TICKER (s)</label><input type="number" class="setting-input" id="setTickerSpeed" placeholder="7" style="background:rgba(0,0,0,0.2); border-radius:8px; padding:6px; text-align:center;"></div></div>
                </div>
                <div class="setting-card-item">
                    <div class="input-row-save" style="justify-content:space-between; margin-bottom:5px;"><span class="setting-label">MULTIPLICADORES</span><button class="btn-save-mini anim-click" onclick="saveMultiSecure()">💾</button></div>
                    <div id="multiGrid" class="multi-grid"></div>
                </div>
            </div>

            <div class="setting-section-title">🔒 SEGURIDAD Y GESTIÓN DE DATOS</div>
            <div class="settings-grid">
                <div class="setting-card-item"><div class="input-row-save"><div style="flex:1"><label class="setting-label">NUEVA CLAVE APP</label><input type="password" class="setting-input" id="setNewPass" placeholder="****" maxlength="4" style="letter-spacing:4px;"></div><button class="btn-save-mini anim-click" onclick="savePassSecure()">💾</button></div></div>
            </div>
            
            <div class="data-actions"><button class="btn-data anim-click" onclick="exportData()">⬇️ EXPORTAR BACKUP</button><button class="btn-data anim-click" onclick="document.getElementById('importFile').click()">⬆️ IMPORTAR BACKUP</button><input type="file" id="importFile" style="display:none" onchange="importData(this)"></div>
            <button class="btn-reset anim-click" style="margin-top:15px; border-color:var(--border); color:var(--text-secondary); background:transparent;" onclick="clearLogs()">🗑️ BORRAR HISTORIAL</button>
            
            <div class="settings-card danger" style="margin-top:20px; border:1px solid var(--danger); background:rgba(207, 48, 74, 0.05); border-radius:16px; padding:15px;">
                <div class="setting-header" style="color:var(--danger); border-bottom:1px solid rgba(207, 48, 74, 0.3); padding-bottom:10px; margin-bottom:10px; font-weight:800;">⚠️ ZONA CRÍTICA</div>
                <div class="setting-info" style="text-align:center; margin-bottom:10px; font-size:12px; color:var(--text-secondary);"><p>Restablecer la aplicación borrará TODOS los datos locales.</p></div>
                <button class="btn-reset anim-click" onclick="resetApp()">RESTABLECER DE FÁBRICA</button>
            </div>

            <div style="text-align:center; font-size:10px; color:var(--text-tertiary); margin-top:20px; font-weight:700; letter-spacing:1px; margin-bottom:40px;">5X V25.31 - 10 SLOTS (MODO LOCAL)</div>
        </div>

        <div id="section-chat" class="app-section">
            <div class="chat-header">
                <div class="chat-header-avatar">👤</div>
                <div class="chat-header-info">
                    <span class="chat-header-name">SOPORTE 5X</span>
                    <span class="chat-header-status" id="chatStatusLabel">● Modo Offline</span>
                </div>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="chat-empty-state" id="chatEmptyState">
                    <p>La mensajería en vivo ha sido deshabilitada en esta versión local.</p>
                </div>
            </div>
            <div class="chat-input-bar">
                <input type="text" class="chat-input" id="chatInput" placeholder="Chat deshabilitado" disabled>
                <button class="chat-send-btn anim-click" disabled>►</button>
            </div>
        </div>

        <div id="tradeModal" class="generic-modal">
            <div class="modal-box section-enter">
                <div class="nav-title" style="color:var(--brand); margin-bottom:10px;">EJECUTAR ORDEN</div>
                <div class="modal-info-text">Estás a punto de enviar una orden real a Gate.io</div>
                <div class="trade-details"><div>PAR: <span id="trade-pair" style="color:var(--text-primary); font-weight:800">BTC_USDT</span></div><div>PRECIO: <span id="trade-price" style="color:var(--text-primary); font-weight:800">0.00</span></div><div>CANTIDAD: <span id="trade-amount" style="color:var(--text-primary); font-weight:800">0.00</span></div><div>TOTAL: <span id="trade-total" style="color:var(--long); font-weight:800">$0.00</span></div></div>
                <button class="btn-modal btn-confirm anim-click" onclick="executeGateOrder()">CONFIRMAR COMPRA</button><button class="btn-modal btn-cancel anim-click" onclick="closeModals()">CANCELAR</button>
            </div>
        </div>

        <div id="confirmModal" class="generic-modal"><div class="modal-box section-enter"><div style="font-family:'Orbitron'; font-size:14px; margin-bottom:15px; color:var(--danger)">¿LIQUIDAR POSICIÓN?</div><p style="font-size:12px; color:var(--text-secondary); margin-bottom:20px;">Esta acción cerrará el slot actual y guardará el registro.</p><button class="btn-modal btn-confirm anim-click" style="background:var(--danger)" onclick="executeRelease()">SÍ, LIQUIDAR</button><button class="btn-modal btn-cancel anim-click" onclick="closeModals()">CANCELAR</button></div></div>
        
        <div id="securityModal" class="generic-modal"><div class="modal-box section-enter"><div style="font-family:'Orbitron'; font-size:12px;">SEGURIDAD</div><input type="password" id="secInput" class="modal-inp" placeholder="••••" maxlength="4" inputmode="numeric" pattern="[0-9]*"><button class="btn-modal btn-confirm anim-click" onclick="validateSecurity()">VALIDAR</button><button class="btn-modal btn-cancel anim-click" onclick="closeModals()">CANCELAR</button></div></div>
    </div>

    <script>
        // ════════════════════════════════════════════════════════════════
        // LÓGICA PRINCIPAL (Adaptada para 100% Local / Sin Firebase)
        // ════════════════════════════════════════════════════════════════
        const Core = { UI: { handleCoinTap: function() {} } };
        let coinPressTimer;
        let basePricePressTimer;
        
        function startCoinPress() { if(coinPressTimer) clearTimeout(coinPressTimer); coinPressTimer = setTimeout(() => { const el = document.getElementById('coinInput'); if(el.hasAttribute('readonly')) { el.removeAttribute('readonly'); el.classList.remove('locked-input'); el.classList.add('manual-edit'); el.value = ''; el.focus(); if(navigator.vibrate) navigator.vibrate(50); showToast("✏️ Escribe el ETF (ej: PEPE3L)"); } }, 1600); }
        function cancelCoinPress() { if(coinPressTimer) clearTimeout(coinPressTimer); }
        function finishEditingCoin() { const el = document.getElementById('coinInput'); if(!el.hasAttribute('readonly')) { let val = el.value.toUpperCase().trim().replace('USDT',''); if(val) { slots[activeIdx].name = val; save(); loadChart(val); calculate(); showToast("✅ Moneda Guardada: " + val); } el.setAttribute('readonly', true); el.classList.add('locked-input'); el.classList.remove('manual-edit'); el.value = slots[activeIdx].name || "---"; } }
        
        function startBasePricePress(e) {
            if (e) e.preventDefault();
            if(basePricePressTimer) clearTimeout(basePricePressTimer);
            basePricePressTimer = setTimeout(() => {
                const el = document.getElementById('baseInput');
                if(el.hasAttribute('readonly')) {
                    el.removeAttribute('readonly');
                    el.classList.remove('locked-input');
                    el.classList.add('manual-edit');
                    el.select();
                    if(navigator.vibrate) navigator.vibrate(50);
                    showToast("✏️ Modifica el precio");
                    el.oninput = function() {
                        const val = parseFloat(this.value);
                        if(!isNaN(val) && val > 0) { slots[activeIdx].price = val; renderLevels(); }
                    };
                }
            }, 1600);
        }
        function cancelBasePricePress() { if(basePricePressTimer) clearTimeout(basePricePressTimer); }
        function finishEditingBasePrice() { const el = document.getElementById('baseInput'); if(!el.hasAttribute('readonly')) { const val = parseFloat(el.value); if(!isNaN(val) && val > 0) { slots[activeIdx].price = val; if (!slots[activeIdx].initialPrice) { slots[activeIdx].initialPrice = val; } save(); renderLevels(); updateDashboardStats(); showToast("💾 Precio guardado: $" + val.toFixed(6)); } el.oninput = null; el.setAttribute('readonly', true); el.classList.add('locked-input'); el.classList.remove('manual-edit'); } }

        // Mapeo y variables principales de datos locales usando prefijo 5x_
        let isLight = localStorage.getItem('theme') === 'light';
        let isPrivateMode = true; 
        
        function createEmptySlots() { return Array(5).fill(null).map(() => ({ name:'', price:0, capital:5, buys:[], strat:'normal', locked: true, roi: 75, note: '', alerted: false, multipleBuys: {} })); }
        let storedReal = localStorage.getItem('5x_slots_real');
        let slots = storedReal ? JSON.parse(storedReal) : createEmptySlots();
        
        slots.forEach(s => { 
            if (!s.buys) s.buys = [];
            if (!s.multipleBuys) s.multipleBuys = {};
            s.strat = 'normal'; 
            if (typeof s.locked === 'undefined') s.locked = true;
            if (!s.capital) s.capital = 5;
            if (!s.roi) s.roi = 75;
            if (!s.note) s.note = '';
            if (typeof s.alerted === 'undefined') s.alerted = false;
        });
        
        while(slots.length < 10) {
            slots.push({ name:'', price:0, capital:5, buys:[], strat:'normal', locked: true, roi: 75, note: '', alerted: false, multipleBuys: {} });
        }
        if (slots.length > 10) slots = slots.slice(0, 10);
        
        let activeIdx = parseInt(localStorage.getItem('5x_last_slot')); if(isNaN(activeIdx)) activeIdx = 0;
        let activeTF = localStorage.getItem('5x_last_tf') || '60';
        let chartSymbol = '';
        let history = JSON.parse(localStorage.getItem('5x_history')) || [];
        let strategyParams = JSON.parse(localStorage.getItem('5x_strategy_params')) || { normal: { capital: 5, roi: 100, inc: 7, desc: 17, dd: 17 } };
        let botConfig = JSON.parse(localStorage.getItem('5x_bot_config')) || { enabled: false, normalProfit: 100, trailingStop: 10, checkInterval: 30, crashDrop: 15, crashWindow: 5, maxLevels: 12, restartDelay: 0 };
        
        if (!strategyParams.normal) strategyParams.normal = { capital: 5, roi: 75, inc: 7, desc: 17, dd: 17 };
        
        let currentSection = 'operate';
        let customMultipliers = JSON.parse(localStorage.getItem('5x_multipliers')) || [1.0, 1.0, 1.5, 1.5, 2.0, 2.0, 5.0, 5.0, 8.0, 8.0, 16.0, 16.0];
        let globalCapital = parseFloat(localStorage.getItem('5x_global_capital')) || 0; 
        let availableUSDT = 1000.00;
        let exchangeFee = parseFloat(localStorage.getItem('5x_fee')) || 0.1;
        let appConfig = JSON.parse(localStorage.getItem('5x_config')) || { pin: '2524', dd: 10 };
        let _rawApiKeys = null;
        try { _rawApiKeys = JSON.parse(localStorage.getItem('5x_api_keys')); } catch(e) {}
        let apiConfig = _rawApiKeys || { key:'', secret:'' };
        
        function save() { 
            try { 
                localStorage.setItem('5x_slots_real', JSON.stringify(slots)); 
                localStorage.setItem('5x_last_slot', activeIdx); 
                saveSlotsLevels();
            } catch (e) { console.error('Error al guardar:', e); } 
        }

        function saveSlotsLevels() {
            const slotsData = slots.map((s, idx) => {
                return { index: idx, name: s.name, price: s.price, capital: s.capital, buys: s.buys || [], strat: s.strat, roi: s.roi, locked: s.locked, note: s.note || '', alerted: s.alerted || false, multipleBuys: s.multipleBuys || {} };
            });
            localStorage.setItem('5x_slots_levels_data', JSON.stringify(slotsData));
        }

        function triggerDriveBackup() {
            const dataStr = JSON.stringify({ slots, history, customMultipliers, globalCapital, appConfig });
            const blob = new Blob([dataStr], {type: "application/json"});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = "5X_Backup.json";
            document.body.appendChild(a);
            a.click();
            showToast("☁️ Archivo generado para respaldo");
        }

        function clearLogs() {
            if(confirm("¿Borrar todo el historial?")) {
                history = [];
                localStorage.setItem('5x_history', JSON.stringify(history));
                renderHistory();
                showToast("🗑️ Historial Borrado");
            }
        }

        function resetApp() {
            if(confirm("¿Estás seguro de restablecer toda la aplicación? Se perderán todos los datos locales.")) {
                localStorage.clear();
                location.reload();
            }
        }

        function showToast(msg, duration = 2000, isAlert = false, isSuccess = false) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.className = isAlert ? 'alert-mode show' : (isSuccess ? 'success-mode show' : 'show');
            setTimeout(() => { t.className = t.className.replace('show', ''); }, duration);
        }

        // Navegación de interfaz y menús
        function switchView(viewId) {
            document.querySelectorAll('.app-section').forEach(el => { el.classList.remove('active'); el.style.display = 'none'; });
            const activeSec = document.getElementById('section-' + viewId);
            if(activeSec) {
                activeSec.style.display = viewId === 'chat' ? 'flex' : 'block';
                setTimeout(() => activeSec.classList.add('active'), 50);
            }
            currentSection = viewId;
            closeMenuViaButton();
        }

        function closeMenuViaButton() {
            document.getElementById('navModal').style.display = 'none';
        }

        function toggleTheme() {
            isLight = !isLight;
            document.body.classList.toggle('light-mode', isLight);
            updateThemeIcon();
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
        }

        function updateThemeIcon() {
            const hint = document.getElementById('themeHint');
            const label = document.getElementById('themeLabel');
            if (hint) hint.textContent = isLight ? '☀️' : '🌙';
            if (label) label.textContent = isLight ? 'CLARO' : 'OSCURO';
        }

        function toggleUserMenu() {
            const dd = document.getElementById('userDropdown');
            if (dd) dd.classList.toggle('open');
        }

        function closeUserMenu() {
            const dd = document.getElementById('userDropdown');
            if (dd) dd.classList.remove('open');
        }
        
        document.addEventListener('click', function(e) {
            const wrapper = document.getElementById('userMenuWrapper');
            if (wrapper && !wrapper.contains(e.target)) closeUserMenu();
        });

        // Inicialización General (Sin Firebase)
        function init() {
            updateThemeIcon();
            renderAllDashboards();
            
            // Cargar datos previos visuales si existen
            const cIn = document.getElementById('coinInput');
            const bIn = document.getElementById('baseInput');
            if (cIn && slots[activeIdx]) cIn.value = slots[activeIdx].name || '';
            if (bIn && slots[activeIdx]) bIn.value = slots[activeIdx].price || '';

            // Habilitar notificaciones en modo local si el navegador lo permite
            if ('Notification' in window && Notification.permission === 'default') {
                setTimeout(() => { document.getElementById('notifPermBanner').style.display = 'flex'; }, 3000);
            }
        }
        
        function dismissNotifBanner() {
            document.getElementById('notifPermBanner').style.display = 'none';
        }

        function requestNotifPermission() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    dismissNotifBanner();
                    if (permission === 'granted') showToast('🔔 Notificaciones activadas', 2500, false, true);
                });
            }
        }
    </script>
</body>
</html>